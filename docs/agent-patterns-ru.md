# Паттерн 1: Итеративный человек в цикле (HILL)

Этот паттерн представляет собой самую базовую форму взаимодействия между человеком и агентом, где каждый шаг требует прямого ручного надзора и проверки.

## Ключевые характеристики
- **Прямой надзор**: Постоянный и явный контроль человека за каждым действием
- **Простота**: Легко понять и реализовать
- **Высокая точность/контроль**: Позволяет тонкие настройки в режиме реального времени
- **Низкая масштабируемость**: Человек является узким местом процесса
- **Идеальная отправная точка**: Идеально подходит для изучения новых решений или сложных проблем

## Контекст использования
- Новые проблемы без установленных решений
- Задачи, требующие критической проверки на каждом этапе
- Быстрое прототипирование и эксперименты
- Ситуации, где человеческая ошибка обходится дорого

# Паттерн 2: Повторно используемые подсказки (пользовательские команды)

Этот паттерн инкапсулирует эффективные подсказки в повторно используемые команды, создавая "рецепты" для общих задач, которые можно выполнять неоднократно.

## Ключевые характеристики
- **Повторное использование**: Единое определение для многократного использования
- **Управление версиями**: Управление как любым другим кодом
- **Эффективность Парето (80/20)**: Максимальная ценность за затраченное время
- **Начальная автоматизация**: Первый шаг к сокращению ручного вмешательства
- **Накладные расходы на конфигурацию**: Требуется организация и обслуживание

## Контекст использования
- Задачи, повторяющиеся три и более раз
- Стандартизированные процессы с минимальными вариациями
- Команда, нуждающаяся в совместном использовании эффективных решений
- Снижение ошибок из-за несоответствия подсказок

# Паттерн 3: Субагенты

Этот паттерн вводит возможность делегирования специализированных задач субагентам, которые могут работать параллельно, позволяя более эффективно распределять обязанности.

## Ключевые характеристики
- **Специализация**: Каждый субагент сосредоточен на конкретной задаче
- **Параллелизация**: Одновременное выполнение нескольких задач
- **Взаимодействие с внешними сервисами**: Структурированная интеграция с API
- **Управление контекстными окнами**: Изоляция информации по контексту
- **Сложность потока информации**: Требуется тщательное управление данными между агентами
- **Зависимость от инструментов**: Требуется специфическая поддержка платформы

## Контекст использования
- Сложные задачи, которые можно разделить на подзадачи
- Необходимость параллельной обработки
- Интеграция с несколькими сервисами или API
- Требования к технической специализации

# Паттерн 4: Оболочка сервера MCP

Обеспечивает централизованный интерфейсный слой, который выступает в качестве моста между агентами и различными сервисами, инкапсулируя логику интеграции в пользовательском сервере.

## Ключевые характеристики
- **Единый интерфейсный слой**: Единственная точка доступа к сложным функциональностям
- **Централизация интеграций**: Упрощение управления несколькими сервисами
- **Полный контроль и настройка**: Точное определение взаимодействий
- **Экспозиция рабочих процессов**: Пользовательские команды для сложных процессов
- **Интеграция с проприетарными сервисами**: Доступ к внутренним системам, недоступным напрямую
- **Постоянное обслуживание**: Требует постоянных обновлений и заботы
- **Ручная сборка**: Логика интеграции должна быть явно разработана

## Контекст использования
- Интеграция с проприетарными или внутренними системами
- Необходимость специфического контроля над взаимодействиями с сервисами
- Сложные рабочие процессы, сочетающие несколько инструментов
- Требования безопасности или контролируемого доступа

# Паттерн 5: Полное приложение (полное приложение)

Это самый продвинутый паттерн, предполагающий создание полноценного программного продукта с несколькими уровнями интерфейса и функциональностью.

## Ключевые характеристики
- **Полный контроль**: Максимальная свобода определения функциональностей
- **Бесконечная расширяемость**: Возможность добавления любых функций
- **Множественные паттерны доступа**: Интегрированные CLI, UI, API и MCP
- **Долгосрочное видение**: Оправдано для продуктов или организационных решений
- **Высокая стоимость/сложность**: Большие инвестиции времени и ресурсов
- **Избыточная квалификация**: Избыток для большинства задач агентов
- **Полная структура**: Комплексное решение для сложных потребностей

## Контекст использования
- Разработка полноценных программных продуктов
- Организационные решения в крупном масштабе
- Необходимость множественных интерфейсов пользователя
- Требования полного контроля над всеми функциональностями

# Иерархия сложности и применимости

## Уровень технической сложности
1. **HILL**: Очень низкий - Прямое взаимодействие
2. **Повторно используемые подсказки**: Низкий - Кодирование подсказок
3. **Субагенты**: Средний - Управление несколькими агентами
4. **Оболочка MCP**: Высокий - Разработка пользовательского сервера
5. **Полное приложение**: Очень высокий - Разработка полного продукта

## Масштабируемость
1. **HILL**: Низкая - Ограничена человеческими возможностями
2. **Повторно используемые подсказки**: Средняя - Повышает индивидуальную эффективность
3. **Субагенты**: Высокая - Параллелизация и специализация
4. **Оболочка MCP**: Высокая - Централизация сервисов
5. **Полное приложение**: Максимальная - Полная архитектура

## Предоставляемая ценность
1. **HILL**: Низкая для повторяющихся задач, высокая для новых решений
2. **Повторно используемые подсказки**: Высокая - Лучшее соотношение ценности/времени
3. **Субагенты**: Высокая - Для сложных и параллелизуемых задач
4. **Оболочка MCP**: Высокая - Для сложных интеграций
5. **Полное приложение**: Переменная - Оправдано только для продуктов

# Рамки принятия решений для выбора паттернов

## Дерево решений
1. **Является ли это новой или исследовательской проблемой?**
   - **ДА** → Паттерн HILL
   - **НЕТ** → Продолжить

2. **Повторяется ли задача 3 или более раз?**
   - **НЕТ** → Оставаться в паттерне HILL
   - **ДА** → Продолжить

3. **Можно ли разделить на независимые подзадачи?**
   - **НЕТ** → Паттерн повторно используемых подсказок
   - **ДА** → Продолжить

4. **Требуется ли параллельная обработка?**
   - **НЕТ** → Паттерн повторно используемых подсказок
   - **ДА** → Продолжить

5. **Необходима ли интеграция с внешними системами?**
   - **НЕТ** → Паттерн субагентов
   - **ДА** → Продолжить

6. **Существует ли долгосрочное продуктовое видение?**
   - **НЕТ** → Паттерн оболочки сервера MCP
   - **ДА** → Паттерн полного приложения

# Рекомендации по реализации

## Последовательная реализация
1. **Начать с HILL** для новых и исследовательских проблем
2. **Перейти к повторно используемым подсказкам** при выявлении повторяющихся задач
3. **Перейти к субагентам** для сложных делимых задач
4. **Рассмотреть оболочку MCP** для сложных интеграций
5. **Реализовать полное приложение** только при наличии четкого продуктового видения

## Стратегические соображения
- **Сохранять простоту**: Начинать с самого простого паттерна, решающего проблему
- **Масштабировать при необходимости**: Увеличивать сложность только когда проблема требует
- **Избегать чрезмерной инженерии**: Не реализовывать сложные решения для простых проблем
- **Планировать на будущее**: Учитывать естественную эволюцию паттернов

Эта документация предоставляет исчерпывающее руководство по пониманию, выбору и реализации 5 паттернов агентов в Qwen Code, позволяя инженерам по ИИ оптимизировать свой рабочий процесс.