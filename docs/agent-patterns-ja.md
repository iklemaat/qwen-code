# パターン1：反復的人間ループ内（HILL）

このパターンは、人間とエージェントの間の最も基本的な相互作用を表し、各ステップで直接的手動の監督と検証が必要です。

## 主な特徴
- **直接監督**：各アクションに対する継続的かつ明示的な人間のコントロール
- **単純性**：理解と実装が容易
- **高精度/コントロール**：リアルタイムでの微調整が可能
- **低スケーラビリティ**：人間がプロセスのボトルネックとなる
- **理想的な出発点**：新しいソリューションや複雑な問題の探求に最適

## 使用ケースコンテキスト
- 確立されたソリューションのない新しい問題
- 各ステップで重要な検証を必要とするタスク
- ラピッドプロトタイピングと実験
- 人的エラーが高コストになる状況

# パターン2：再利用可能なプロンプト（カスタムコマンド）

このパターンは、効果的なプロンプトを再利用可能なコマンドにカプセル化し、一般的なタスクを繰り返し実行できる「レシピ」を作成します。

## 主な特徴
- **再利用性**：一度定義すれば複数回使用可能
- **バージョン管理**：他のコードと同様の管理が可能
- **パレート効率（80/20）**：投資時間あたりの最大価値
- **初期自動化**：手動介入削減への第一歩
- **設定オーバーヘッド**：整理とメンテナンスが必要

## 使用ケースコンテキスト
- 3回以上繰り返されるタスク
- 変更が最小限の標準化されたプロセス
- 効果的なソリューションを共有する必要があるチーム
- プロンプトの一貫性不足によるエラーの削減

# パターン3：サブエージェント

このパターンでは、特殊化されたタスクを並列に実行できるサブエージェントに委任する機能が導入され、責任のより効率的な分担が可能になります。

## 主な特徴
- **専門化**：各サブエージェントは特定のタスクに集中
- **並列化**：複数タスクの同時実行
- **外部サービスとのインタラクション**：APIとの構造化統合
- **コンテキストウィンドウ管理**：コンテキスト別の情報分離
- **情報フローの複雑性**：エージェント間のデータ管理を慎重に行う必要
- **ツール依存性**：特定のプラットフォームサポートが必要

## 使用ケースコンテキスト
- サブタスクに分割可能な複雑なタスク
- 並列処理の必要性
- 複数のサービスまたはAPIとの統合
- 技術的専門知識の必要性

# パターン4：ラッパーMCPサーバー

様々なサービスとエージェントの間の橋渡しとなる中心的なインターフェース層を提供し、統合ロジックをカスタムサーバーにカプセル化します。

## 主な特徴
- **統一インターフェース層**：複雑な機能への単一アクセスポイント
- **統合の集中化**：複数サービス管理の簡素化
- **完全なコントロールとカスタマイズ**：インタラクションの精確な定義
- **ワークフローの公開**：複雑なプロセスのためのカスタムコマンド
- **独自サービスとの統合**：直接アクセスできない内部システムへのアクセス
- **継続的メンテナンス**：継続的な更新と管理が必要
- **手動構築**：統合ロジックを明示的に開発する必要

## 使用ケースコンテキスト
- 独自または内部システムとの統合
- サービスインタラクションに対する特定のコントロールの必要性
- 複数ツールを組み合わせた複雑なワークフロー
- セキュリティまたは制御されたアクセスの必要性

# パターン5：フルアプリケーション（完全なアプリケーション）

これは、複数のインターフェース層と機能を持つ完全なソフトウェア製品を構築する最も高度なパターンです。

## 主な特徴
- **完全なコントロール**：機能定義の最大限の自由度
- **無限の拡張性**：任意の機能追加が可能
- **複数のアクセスパターン**：統合されたCLI、UI、API、およびMCP
- **長期ビジョン**：製品または組織ソリューションに正当化
- **高コスト/複雑性**：時間とリソースの大きな投資
- **過剰適合**：ほとんどのエージェント問題に対して過剰
- **完全なフレームワーク**：複雑なニーズのための包括的ソリューション

## 使用ケースコンテキスト
- 完全なソフトウェア製品開発
- 大規模組織ソリューション
- 複数のユーザーインターフェースの必要性
- すべての機能に対する完全なコントロールの必要性

# 複雑さと適用可能性の階層

## 技術的複雑さレベル
1. **HILL**：非常に低い - 直接インタラクション
2. **再利用可能プロンプト**：低い - プロンプトエンコーディング
3. **サブエージェント**：中程度 - 複数エージェントの管理
4. **ラッパーMCP**：高い - カスタムサーバー開発
5. **フルアプリケーション**：非常に高い - 完全製品開発

## スケーラビリティ
1. **HILL**：低い - 人的能力に制限
2. **再利用可能プロンプト**：中程度 - 個人効率の向上
3. **サブエージェント**：高い - 並列化と専門化
4. **ラッパーMCP**：高い - サービスの集中化
5. **フルアプリケーション**：最大 - 完全アーキテクチャ

## 提供される価値
1. **HILL**：繰り返しタスクには低い、新規ソリューションには高い
2. **再利用可能プロンプト**：高い - 最良の価値/時間比
3. **サブエージェント**：高い - 複雑で並列化可能なタスクに
4. **ラッパーMCP**：高い - 複雑な統合に
5. **フルアプリケーション**：変動 - 製品に対してのみ正当化

# パターン選択の決定フレームワーク

## 決定ツリー
1. **これは新しい探索的問題ですか？**
   - **はい** → HILLパターン
   - **いいえ** → 続行

2. **タスクは3回以上繰り返されますか？**
   - **いいえ** → HILLパターンのまま
   - **はい** → 続行

3. **独立したサブタスクに分割できますか？**
   - **いいえ** → 再利用可能プロンプトパターン
   - **はい** → 続行

4. **並列処理が必要ですか？**
   - **いいえ** → 再利用可能プロンプトパターン
   - **はい** → 続行

5. **外部システムとの統合が必要ですか？**
   - **いいえ** → サブエージェントパターン
   - **はい** → 続行

6. **長期的な製品ビジョンがありますか？**
   - **いいえ** → ラッパーMCPサーバーパターン
   - **はい** → フルアプリケーションパターン

# 実装推奨事項

## 段階的実装
1. **HILLから開始**：新しい探索的問題に対応
2. **再利用可能プロンプトへ進化**：繰り返しタスクが特定されたら
3. **サブエージェントへ前進**：複雑な分割可能問題に対応
4. **ラッパーMCPサーバーを検討**：複雑な統合に対応
5. **フルアプリケーションは明確な製品ビジョン時のみ実装**

## 戦略的考慮事項
- **シンプルに保つ**：問題を解決する最も簡単なパターンから開始
- **必要な時にスケール**：問題が要求する場合にのみ複雑性を増加
- **過剰設計を避ける**：簡単な問題に複雑なソリューションを実装しない
- **将来を見据える**：パターンの自然な進化を考慮

このドキュメントは、Qwen Codeにおける5つのエージェントパターンを理解・選択・実装するための包括的なガイドを提供し、AIエンジニアがワークフローを最適化できるようにします。